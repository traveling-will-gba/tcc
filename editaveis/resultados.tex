\chapter[Resultados]{Resultados}

Este capítulo irá apresentar os resultados obtidos durante a realização deste trabalho. Serão mostrados os prótotipos iniciais do jogo, a \textit{engine} desenvolvida para a construção do jogo e, por fim, as telas do jogo final desenvolvido.

\section{Protótipo inicial}

A fim de atestar a viabilidade do porte do jogo \textit{Traveling Will}, desenvolvido inicialmente para PC, para a plataforma \textit{Nintendo Game Boy Advance}, foi feita uma versão funcional do menu original do jogo, já testada em um \textit{Nintendo DS} (como explicado na Seção \ref{console} do Capítulo \ref{metodologia}). Para isso, a principal ferramenta utilizada foi a \textit{libtonc}\footnote{\textit{libtonc}, disponível em \url{http://www.coranac.com/files/tonc-code.zip}}, que nessa versão inicial fez o papel de \textit{engine} do jogo.

Abaixo é possível comparar o menu principal do jogo original com o protótipo implementado sendo executado em um emulador de \textit{Game Boy Advance}:

\begin{figure}%
    \centering
    \subfloat[Jogo original sendo executado em um PC. Fonte: \textit{Autores}.]{{\includegraphics[width=16cm]{figuras/tw-original-1.eps} }}%
    \qquad
    \subfloat[Protótipo sendo executado no emulador de GBA. Fonte: \textit{Autores}.]{{\includegraphics[width=16cm]{figuras/tw-gba-1.eps} }}%
    \caption{Comparação entre o jogo original e o protótipo no emulador.}%
    \label{fig:example}%
\end{figure}

Este protótipo inicial contém apenas a tela vista acima, com um \textit{background} desenhado ao fundo e quatro botões clicáveis, porém sem nenhuma ação após o clique. Para alterar o botão selecionado, basta

O protótipo desenvolvido está disponível no seguinte repositório: \url{https://github.com/traveling-will-gba/traveling-will-prototype}

\section{Desenvolvimento da \textit{engine}}

  Logo após a finalização do protótipo, foi iniciado o desenvolvimento da \textit{engine} responsável por substituir a \textit{libtonc} e gerenciar os recursos do jogo. Esta \textit{engine} contém os seguintes módulos: \textit{input}, vídeo, gerenciador de memória, áudio e física. Além disso, a \textit{engine} contém abstrações para os níveis (\textit{levels}) e objetos do jogo (\textit{game objects}) e um módulo utilitário para funções genéricas relacionadas ao \textit{hardware} do GBA.

  Os módulos de vídeo, \textit{input}, física e as abstrações para níveis e objetos do jogo foram desenvolvidos tendo como base a \textit{ijengine}\footnote{\textit{ijengine}, disponível em \url{https://github.com/fgagamedev/ijengine}}, \textit{engine} desenvolvida para a disciplina de Introdução aos Jogos Eletrônicos, que tem como foco a criação de jogos para PC utilizando \textit{C++}. Ela contém módulos de vídeo, áudio, manipulação de eventos, física, \textit{input}, dentre outros, e contém uma interface para a utilização de diferentes bibliotecas gráficas, como SDL\footnote{\textit{Simple DirectMedia Layer}, disponível em \url{https://www.libsdl.org}} e OpenGL\footnote{OpenGL, disponível em \url{https://www.opengl.org}}.

  \input{editaveis/modulo-input}

  \input{editaveis/modulo-video}

  \input{editaveis/modulo-gerenciador-memoria}

  \input{editaveis/modulo-fisica}

  \input{editaveis/modulo-utils}

  \input{editaveis/level-game-object}

\section{Desenvolvimento do jogo}

  De acordo com o cronograma apresentado na versão anterior, as funcionalidades do jogo original que foram planejadas para a realização deste trabalho são:

  \begin{itemize}
    \item F1: implementação do menu principal do jogo
    \item F2: implementação da rolagem infinita dos \textit{backgrounds}
    \item F3: implementação do mecanismo de renderização das plataformas
    \item F4: implementação da movimentação do personagem principal
    \item F5: implementação do mecanismo de renderização dos itens coletáveis
    \item F6: implementação das telas de finalização dos níveis
    \item F7: carregamento dos níveis a partir do \textit{level design}
    \item F8: implementação do seletor de fases
    \item F9: implementação das opções do menu
    \item F10: implementação do tutorial
  \end{itemize}

  Da lista acima, as funcionalidades \texttt{F8}, \texttt{F9} e \texttt{F10} foram removidas da realização do projeto.

  O desenvolvimento do jogo foi marcado por quatro fases principais (que ocorreram simultaneamente): adaptação das imagens do jogo, construção dos níveis do jogo, transição entre os níveis do jogo e adaptação das músicas do jogo.

  \input{editaveis/adaptacao-imagens}

  \input{editaveis/construcao-niveis}

  \input{editaveis/transicao-niveis}

  \input{editaveis/adaptacao-musicas}

  \input{editaveis/comparacao-porte}

% - adaptações em relação ao jogo original
%   - não possui opção para configurar o áudio durante o jogo
%   - não possui mecanismo de salvamento de dados do jogo
%   - não possui inimigos (ainda dá)
%   - não possui seletor de fase
%     - as fases são jogadas em ordem
%     - é possível pular de fase pressionando SELECT

% - transformar as imagens do jogo (Adaptação das imagens do jogo)
%   - proporção 3:1
%   - paleta de 15 cores
%     - bit 0 transparente, mas o grit não faz isso certo
%     - especificar comandos do grit gerados para backgrounds e paletas
%   - backgrounds
%     - especificar paleta de cores na hora de gerar o grit
%     - como foi feito o scroll infinito dos backgrounds
%       - falar sobre os registradores
%   - texturas
%     - animação -> como foi feita
%     - plataformas -> uma plataforma contém várias sprites
%       - metadata.om = 2 para esconder as plataformas da tela (senão portal)
%         - colocar imagem do portal
%     - problemas com lixo na OAM, sprites espelhando

% - parse do level design (Construção de um nível do jogo)
%   - explicar como é o level design do traveling will
%   - explicar o que o parser gera e como ele é usado no jogo
%   - colocar código do parser python
%   - explicar o uso de fila para as plataformas (pouca memória)
%     - construtor por cópia
%   - velocidade das plataformas é dada pela velocidade do background mais a frente
%   - fim do level tudo para
%     - will se mexe

% - Transição entre níveis do jogo
%   - dois tipos de níveis (jogáveis e não-jogáveis)
%   - escolha do nível a ser construído
%     - switch case
%       - não era possível modularizar por causa das variáveis (inferência de nome)

% - Adaptação das músicas do jogo
%   - falar brevemente sobre os canais de áudio do gba e colocar referência
%   - falar que o módulo de áudio atual permite reproduzir notas únicas (ondas quadradas?)
%   - colocar código da reprodução da notas
%   - falar do parser do level design para extrair a música do level
%     - explicar o que ele gera
%   - colocar código do parser
%   - explicar que esse modelo não foi utilizado por era muito simples
%   - falar que o GBA consegue reproduzir apenas sons .mode
%   - falar sobre conversão de wav pra mod
%     - falar sobre a quantidade de bits do wav (colocar referência)
%     - conversão da quantidade de bits do wav
%     - conversão do wav pra mod (usando a ferramenta X)
%       - qualidade do som diminui bastante
%   - problemas em executar o nível e o áudio ao mesmo tempo
%     - sincronização da música com o level e velocidade do jogo

% - problemas gerais
%   - depuração de código
%     - rodar debuggers (gdb, etc)
%     - somente a base de print

% - o que não foi feito
%   - mixer sofisticado
%   - módulo de texto
%     - fontes bitmap mode + outras prioridades
%   - inimigos (ainda dá)